## 线程崩溃会导致进程崩溃吗？

取决于线程崩溃的原因和如何处理这种情况。由于进程中的线程共享地址空间，一个线程的行为可能会影响整个进程。如果一个线程因为未捕获的异常（如访问非法内存、除零错误等）而崩溃，那么通常这会导致整个进程终止。这是因为这类异常通常会引发信号（如SIGSEGV、SIGABRT等），**如果这些信号没有被适当处理，操作系统默认的行为是终止整个进程**。

比如当我们使用kill命令终止一个进程时（普通用户只能kill用户为（UGO）自己的进程，程序的U为创建它的用户），其背后的机制如下

- CPU 执行正常的进程指令
- 调用 kill 系统调用向进程发送信号
- 进程收到操作系统发的信号，CPU 暂停当前程序运行，并将控制权转交给操作系统
- 调用 kill 系统调用向进程发送信号（假设为 11，即 SIGSEGV，一般非法访问内存报的都是这个错误）
- 操作系统根据情况执行相应的信号处理程序（函数），一般执行完信号处理程序逻辑后会让进程退出

如果进程没有注册自己的信号处理函数，那么操作系统会执行默认的信号处理程序（一般最后会让进程退出），但如果注册了，则会执行自己的信号处理函数，这样的话就给了进程一个垂死挣扎的机会，它收到 kill 信号后，可以调用 exit() 来退出，但也可以使用 sigsetjmp，siglongjmp 这两个函数来恢复进程的执行。也就是说虽然给进程发送了 kill 信号，但如果进程自己定义了信号处理函数或者无视信号就有机会逃出生天，当然了 kill -9 命令例外，不管进程是否定义了信号处理函数，都会马上被干掉。